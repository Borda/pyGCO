# vim ft=yaml

# After changing this file, check it on:
#   http://yaml-online-parser.appspot.com/

language: python

sudo: true

python:
  - 2.7
  - 3.4
  - 3.5

cache: pip

env:
  - CI_REPORTS=shippable/testresults COVERAGE_REPORTS=shippable/codecoverage

before_install:
#  - mkdir gco_source
  - pip install --upgrade pip
#  - apt-get install freetype*

install:
  - pip install -r requirements.txt
  - pip install pytest>=3.1.3 coverage codecov nose  #

  - make download
  - make all
  - make test_wrapper
  - ls libcgco.*
  - make rm

  - python setup.py build_ext --inplace
#  - python setup.py install

before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage

script:
  - ls libcgco.*
#  - ./test_wrapper
  - python -m pytest --doctest-modules --ignore=setup.py
  - coverage run --source=pygco test_examples.py
  - coverage xml -o shippable/codecoverage/coverage.xml

after_success:
  - codecov -t 1aef0194-048a-4c59-a0d1-9408b924c493
  - coverage report